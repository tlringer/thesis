Handshake :=(@\vspace{-0.04cm}@)
  seq 32 bool * seq 32 bool.(@\vspace{-0.04cm}@)
(@\phantom{\}.}@)(@\vspace{-0.04cm}@)
Connection :=(@\vspace{-0.04cm}@)
  bool * (seq 2 bool *(@\vspace{-0.04cm}@)
 (seq 8 bool * (Handshake *(@\vspace{-0.04cm}@)
 (bool * (bool *(@\vspace{-0.04cm}@)
 (seq 32 bool * (bool *(@\vspace{-0.04cm}@)
  bool))))))).(@\vspace{-0.04cm}@)
(@\phantom{\}.}@)

Record Handshake := (@\codediff{MkHandshake}@) {(@\vspace{-0.04cm}@)
  (@\codediff{handshakeType}@) : seq 32 bool; (@\codediff{messageNumber}@) : seq 32 bool(@\vspace{-0.04cm}@)
}.(@\vspace{-0.04cm}@)
Record Connection := (@\codediff{MkConnection}@) {(@\vspace{-0.04cm}@)
  (@\codediff{clientAuthFlag}@) : bool;  (@\hspace{0.04cm}@)  (@\codediff{corked}@) : seq 2 bool;(@\vspace{-0.04cm}@)
  (@\codediff{corkedIO}@) : seq 8 bool;     (@\codediff{handshake}@) : Handshake;(@\vspace{-0.04cm}@)
  (@\codediff{isCachingEnabled}@) : bool; (@\codediff{keyExchangeEPH}@) : bool;(@\vspace{-0.04cm}@)
  (@\codediff{mode}@) : seq 32 bool;      (@\hspace{0.03cm}@)  (@\codediff{resumeFromCache}@) : bool;(@\vspace{-0.04cm}@)
  (@\codediff{serverCanSendOCSP}@) : bool;(@\vspace{-0.04cm}@)
}.
